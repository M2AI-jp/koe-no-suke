# **state.md**

3つのエージェントが作業する: Codex (開発)、GitHub操作エージェント (本ドキュメントの対象)、レビューAI。
各エージェントはこれらのステータスを参照して次のステートへ進みます。ステータスの変更は state.md の `main status` & `sub status` 行のみを更新してください。

## **main status**

review

## **sub status**

playbook-spec-updates-pr-created

\*以下の編集を禁止する

## **sub status運用ガイド**

- 命名規則: `phase<番号>-<短い説明>` 形式のケバブケースを基本とし、フェーズ横断の事項は `global-` または `ops-` で始めます。
- 更新タイミング: `main status` の変更ごと、もしくは同一ステート内で注力中のトピックが変わった際にのみ更新します。
- 記載内容: 現在進行中のフェーズやPR名など、次のアクション判断に必要な短いラベルを1件だけ保持します。
- 管理責任: `main status` を更新したエージェントが `sub status` も必ず見直し、最新状態に揃えます。

## **main status一覧**

### **coding**

* 説明: 新規機能の実装やリファクタリング、バグ修正を行うステートです。テスト駆動開発に基づき、ローカル環境で必要なテストを実行して成功させます。  
* 作業内容: 新機能追加、バグ修正、リファクタリング、必要なテストの実行。  
* 担当エージェント: Codex（生成AI）

  ### **pr\_preparation**

* 説明: 実装した変更を専用ブランチにコミットし、プルリクエストを作成してレビュープロセスに備えるステートです。  
* 作業内容: ブランチの作成、変更のコミット、プルリクエストの作成と記入、進捗や成果物のまとめ。  
* 担当エージェント: GitHub操作エージェント

  ### **review**

* 説明: 提出されたプルリクエストに対してレビューAIがコメントや修正要求を行うステートです。  
* 作業内容: コードレビュー、改善点の指摘、修正要求。  
* 担当エージェント: レビューAI

  ### **fix**

* 説明: レビューAIからのコメントや修正要求を受け、必要な修正やリファクタリングを実施するステートです。修正ごとにローカルでテストを実行し、単一作業原則を守りながら修正を完了させます。  
* 作業内容: 修正の実装、必要なテストの実行、必要に応じて再コミット。  
* 担当エージェント: Codex（生成AI）

  ### **integration**

* 説明: 修正が承認され、プルリクエストが完了した変更を統合ブランチにマージするステートです。main ブランチではなく、必要に応じて組み合わせブランチや新しいステージングブランチに統合します。  
* 作業内容: ブランチのマージ、コンフリクト解決、必要なテストの実行。  
* 担当エージェント: GitHub操作エージェント（必要に応じてユーザー判断を含む）

  ### **done**

* 説明: 統合作業が完了し、タスクが正式に終了したステートです。  
* 作業内容: 特になし（次のタスクがあれば新しいブランチを作成して coding ステートから開始します）。  
* 担当エージェント: なし

  ## **ステート遷移ルール**

* coding → pr\_preparation → review → fix → review を繰り返し、レビューAIが「修正不要」と判断したら integration → done へ遷移します。  
* review で修正要求がある場合は fix に遷移し、修正後に再び review に戻ります。必要な回数だけループして完了させます。  
* done から次のタスクへ進む際は、新しいブランチを作成し、coding ステートから開始します。  
* 各ステートでは単一ファイルおよび単一作業の原則を遵守します。  
* ステータスの変更は state.md の `main status` & `sub status` 行のみを更新してください。各エージェントはこれらのステータスを参照して次のステートへ進みます。
