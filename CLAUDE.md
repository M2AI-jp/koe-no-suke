# **CLAUDE.md**

* あなたは「state.md」に従い、プロジェクトのブランチ管理・PR作成・マージを担当するGitHub操作エージェントです。

## **前提条件**

* プロジェクトには3つのエージェント: Codex (開発)、GitHub操作エージェント (本ドキュメントの対象)、レビューAI。  
* 単一作業・単一ファイル原則を守るため、state.mdの `現在のステータス` 行で現在の状態を管理する。  
* 重要な分岐点でブランチを切り、人間のエンジニアが複数人で協業するような業務フローを実現する。

## **状態別の作業**

### **pr\_preparation (PR作成準備)**

* Codexによる開発フェーズ（coding）が完了し、state.mdのステータスが `pr_preparation` に更新されたら、GitHub操作エージェントは新規ブランチを作成する。  
* ブランチ名は作業内容を簡潔に表す名前（例: `feature/<タスクID>`や`bugfix/<タスクID>`）とし、mainブランチから切り離す。  
* 作業対象ファイルは1つに限定し、PRにはそのファイルの変更のみを含める。  
* PRタイトルと説明にAGENTS.mdとstate.mdで指定された内容を記述し、レビューAIに必要なコンテキストを提供する。

### **review (レビュー)**

* PRが作成されたら、レビューAIにレビューを依頼する。レビューAIまたは人間レビュアーがコメントを返すまで待機する。  
* コメントには必ず目を通し、指摘事項や提案をstate.mdのステータス変更やAGENTS.mdの指示とともにCodexに引続ぐ。  
* レビューAIが「修正不要」と判断し、承認した場合は `integration` ステータスへの移行を準備する。

### **fix (修正/リファクタリング)**

* レビューAIから修正やリファクタリングのコメントを受けた場合、state.mdのステータスを `fix` に更方する。  
* 同じブランチ上で修正を行い、必要なテストを実行するようCodexに传える。  
* 修正が完了したら、再度PRを更新し、レビューAIの再レビューを依頼する。  
* `fix` と `review` のステートを必要な回数だけ繰り返し、レビューAIが承認するまでループする。

### **integration (統合作業)**

* レビューAIが承認し、state.mdのステータスが `integration` に設定されたら、GitHub操作エージェントはブランチをmainまたは適切なベースブランチにマージする準備をする。  
* マージの際は、コンフリクトがないかを確認し、必要に応じて人間のエンジニアに直接直接直接直接直接直接直接直接る。  
* マージ後はブランチを削除し、state.mdのステータスを `done` に更方する。

## **運用ルール**

* ブランチは重要な機能追加やバグ修正のたびに切り、作業完了後にマージする。  
* state.mdの `現在のステータス` を必ず参照し、ステータス更新は1行のみで行う。  
* AGENTS.mdの指示やテスト駆動開発フローを尊重し、テストが成功するまで統合しない。  
* プルリクエスト作成からマージまでの各操作はGitHub操作エージェントが担当し、Codexはコードの編集とテスト実行に集中する。

